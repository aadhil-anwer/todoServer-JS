<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="Get()">
    <input type="text" name="title" id="title" placeholder=" Task Title"> <br><br>
    <input type="text" name="" id="description" placeholder="description"><br><br>
    <button type="button" onclick="Post()">Add </button>
    <div id="mainarea">Hi There</div>
</body>
<script>
    
    function parsedresp(data) {
        console.log(data);
        var parentElement= document.getElementById("mainarea");
        // parentElement.innerHTML=JSON.stringify(data);
        for(var i=0;i<data.length;i++){
            var childElement = document.createElement("div");
            var grandchild1=document.createElement("span");
            grandchild1.innerHTML=data[i].title;
            var grandchild2=document.createElement("span");
            grandchild2.innerHTML=data[i].description;
            var grandchild3 =document.createElement("button");
            grandchild3.innerHTML="Delete"
            grandchild3.setAttribute("onclick","deleteTodo("+ data[i].id+ ")")


            childElement.appendChild(grandchild1);
            childElement.appendChild(grandchild2);
            childElement.appendChild(grandchild3);
            parentElement.appendChild(childElement);
            
        }

    }


    function callback(resp) {
        resp.json().then(parsedresp);
    }

    function Get() {
        fetch('http://localhost:3000/todos', {
            method: "GET"
        }).then(callback);
    }

    function Post() {
        var title= document.getElementById("title").value;
        var description= document.getElementById("description").value;
        const postData = {
            title: title,
            description: description
        };

        fetch('http://localhost:3000/todos', {
            method: "POST",
            body: JSON.stringify(postData),
            headers: {
                "Content-Type": "application/json"
            }
        }).then(callback);
        location.reload();
    }
    function deleteTodo(id){
        fetch('http://localhost:3000/delete/'+id, {
            method: "DELETE",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(callback2);
        location.reload();
    }
    function callback2(resp) {
        resp.json().then(parsedresp2);
    }
    function parsedresp2(data){
        console.log(data);
    }
</script>
</html>